<h2>问题点：</h2><ul><li>在开发微信微官网的时候，会同时存在两个导航栏的情况：微信自带导航栏和WebApp内建导航栏。按照常理两者导航结果要同步才能达到体验一致的效果。</li><li>ionic使用的导航方式永远都是在新增历史记录（$ionicHistory.goBack(-1)）,而浏览器原生的导航则是在历史记录中有前有后的跳转,因而使用$ionicHistory会在用户操作的过程出现导航不同步的现象</li><li>&quot;返回&quot;可以用history.go(-1)解决，但是“返回首页”的问题就有些棘手，因为返回首页的另一个意思就是，返回历史记录的第一个页面，如果第一个页面不是“home”，那就将第一个页面换成“home”。</li></ul><h2>解决方案：</h2><ul><li>内建历史记录的数组，path改变就对内建历史记录进行更新，东西不难拿笔画画流程就清楚了。</li><li>方法backToHome返回首页，goBack后退，HistoryArr维护历史记录。</li><li>上面两个方法挂载到mainCtrl根控制器的$rootScope下,这样的话在别的controller中也可手动调用此方法。</li></ul><p><code></code>` angular.module(&#39;controllers&#39;) .controller(&#39;mainCtrl&#39;, [&#39;$scope&#39;, &#39;$sessionStorage&#39;, &#39;$state&#39;, &#39;$ionicHistory&#39;, &#39;$rootScope&#39;, &#39;$log&#39;, &#39;$timeout&#39;, &#39;$window&#39;, &#39;$location&#39;, function ($scope, $sessionStorage, $state, $ionicHistory, $rootScope, $log, $timeout, $window, $location) { /** <em>定义后退和返回操作 </em>*/ $rootScope.HistoryArr = []; $rootScope.$on(&quot;$locationChangeSuccess&quot;, function () { var currentPath = $location.path(); //倒数第一个 var back1Path = $rootScope.HistoryArr[$rootScope.HistoryArr.length-1]; //如果是后退的情况,则不记录历史记录 if($rootScope.HistoryArr.length&gt;1){ //倒数第二个 var back2Path = $rootScope.HistoryArr[$rootScope.HistoryArr.length-2]; if(currentPath != back1Path){ if(currentPath != back2Path){ //前进状态 $rootScope.HistoryArr.push(currentPath); }else{ //激活了浏览器的后退,这里只需要更新状态 $rootScope.HistoryArr.length = $rootScope.HistoryArr.length-1; } }else{ //当前状态就是数组的最后一个,这里不做处理 } }else{ if(back1Path != currentPath){ $rootScope.HistoryArr.push(currentPath); } } });</p><pre><code>$rootScope.backToHome = function () {var len = $rootScope.HistoryArr.length;//截断$rootScope.HistoryArr.length = 1;//直接回到第一个页面,一定是主页//如果不是home则转到home//因为bug,无奈之举if( $rootScope.HistoryArr[0] != &quot;/home&quot;){$rootScope.HistoryArr.length = 0;$location.path(&#39;/home&#39;);}else{$window.history.go(1 - len);}};$rootScope.goBack = function (step) {!step &amp;&amp; (step = 1);step = parseInt(step);if(isNaN(step)){return &quot;step must be a number&quot;;}//截断$rootScope.HistoryArr.length = $rootScope.HistoryArr.length-step;$window.history.go(-(step));};}]);</code></pre><p><code></code>`</p>